<div class="header">
  <h1>E-postadresser</h1>
</div>
  <% activity_table(@first_period, @second_period) do %>
    <tbody>
      <tr class="totals">
        <th scope="colgroup">E-postadresser</th>
        <% num_first_period, num_second_period = Registration.with_period(@first_period).confirmed.with_opt_in.count, Registration.with_period(@second_period).confirmed.with_opt_in.count -%>
        <% diff = num_first_period - num_second_period -%>
        <td><%= num_second_period %> st</td>
        <td><%= num_first_period %> st</td>
        <td><%= '+' if diff > 0 %><%= diff %> st</td>
      </tr>
      <tr>
        <th scope="row">Via anmÃ¤lan</th>
        <% num_direct_first_period, num_direct_second_period = NewsletterSubscription.with_period(@first_period).confirmed.count, NewsletterSubscription.with_period(@second_period).confirmed.count -%>
        <% diff = num_direct_first_period - num_direct_second_period %>
        <td><%= num_direct_second_period %> st</td>
        <td><%= num_direct_first_period %> st</td>
        <td><%= '+' if diff > 0 %><%= diff %> st</td>
      </tr>
      <tr>
        <th scope="row">Via opt-in</th>
        <% diff = (num_first_period - num_direct_first_period) - (num_second_period - num_direct_second_period) %>
        <td><%= num_second_period - num_direct_second_period %> st</td>
        <td><%= num_first_period - num_direct_first_period %> st</td>
        <td><%= '+' if diff > 0 %><%= diff %> st</td>
      </tr>
    </tbody>
  <% end %>
</div>
